generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model repository {
  repo_id        BigInt     @id
  name           String?    @db.VarChar(255)
  full_name      String?    @db.VarChar(255)
  private        Boolean?
  html_url       String?
  description    String?
  default_branch String?    @db.VarChar(255)
  language       String?    @db.VarChar(255)
  created_at     DateTime?  @db.Timestamp(6)
  updated_at     DateTime?  @db.Timestamp(6)
  pushed_at      DateTime?  @db.Timestamp(6)
  owner_login    String?    @db.VarChar(255)

  commits  commit[]
  files    file[]
  issues   issue[]
  pulls    pull[]
}

model commit {
  commit_sha   String       @id @db.VarChar(255)
  repo_id      BigInt?
  author_name  String?      @db.VarChar(255)
  author_email String?      @db.VarChar(255)
  date         DateTime?    @db.Timestamp(6)
  message      String?
  parent_sha   String?      @db.VarChar(255)

  repository repository? @relation(fields: [repo_id], references: [repo_id], onDelete: Cascade, onUpdate: NoAction)
}

model file {
  file_id      String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  repo_id      BigInt?
  path         String
  sha          String?      @db.VarChar(255)
  size         Int?
  type         String?      @db.VarChar(50)

  repository repository? @relation(fields: [repo_id], references: [repo_id], onDelete: Cascade, onUpdate: NoAction)
}

model issue {
  issue_id    Int           @id
  repo_id     BigInt?
  title       String?
  state       String?       @db.VarChar(50)
  created_at  DateTime?     @db.Timestamp(6)
  closed_at   DateTime?     @db.Timestamp(6)

  repository repository? @relation(fields: [repo_id], references: [repo_id], onDelete: Cascade, onUpdate: NoAction)
}

model pull {
  pull_id     Int           @id
  repo_id     BigInt?
  title       String?
  state       String?       @db.VarChar(50)
  created_at  DateTime?     @db.Timestamp(6)
  closed_at   DateTime?     @db.Timestamp(6)

  repository repository? @relation(fields: [repo_id], references: [repo_id], onDelete: Cascade, onUpdate: NoAction)
}
